F:\my-neuro\run_rag.py:117: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
INFO:     Started server process [3716]
INFO:     Waiting for application startup.
启动BGE API服务...
加载模型...
C:\Users\Maoweicao\.conda\envs\my-neuro\Lib\site-packages\torch\_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
模型加载完成，使用GPU
知识库加载完成，共 1 个段落
生成知识库嵌入...
ERROR:    Traceback (most recent call last):
  File "C:\Users\Maoweicao\AppData\Roaming\Python\Python311\site-packages\starlette\routing.py", line 692, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "C:\Users\Maoweicao\AppData\Roaming\Python\Python311\site-packages\starlette\routing.py", line 569, in __aenter__
    await self._router.startup()
  File "C:\Users\Maoweicao\AppData\Roaming\Python\Python311\site-packages\starlette\routing.py", line 669, in startup
    await handler()
  File "F:\my-neuro\run_rag.py", line 133, in startup_event
    knowledge_embeddings = model.encode(knowledge_base)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Maoweicao\.conda\envs\my-neuro\Lib\site-packages\torch\utils\_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Maoweicao\AppData\Roaming\Python\Python311\site-packages\sentence_transformers\SentenceTransformer.py", line 1109, in encode
    all_embeddings = np.asarray([emb.numpy() for emb in all_embeddings])
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Maoweicao\AppData\Roaming\Python\Python311\site-packages\sentence_transformers\SentenceTransformer.py", line 1109, in <listcomp>
    all_embeddings = np.asarray([emb.numpy() for emb in all_embeddings])
                                 ^^^^^^^^^^^
RuntimeError: Numpy is not available

ERROR:    Application startup failed. Exiting.
